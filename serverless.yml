service: lambda-dlq-testing

custom:
   accountNumber: ${opt:account-number}

provider:
   name: aws
   runtime: nodejs8.10
   iamRoleStatements:
      -
         Effect: Allow
         Action:
            - sns:Publish
         Resource:
            - 'arn:aws:sns:us-east-1:${self:custom.accountNumber}:lambda-dlq-testing-SNSTopic'

functions:
   hello:
      handler: handler.hello

resources:
   Resources:
      HelloLambdaFunction:
         Type: 'AWS::Lambda::Function'
         Properties:
            DeadLetterConfig:
               TargetArn: 'arn:aws:sns:us-east-1:${self:custom.accountNumber}:lambda-dlq-testing-SNSTopic'
      SNSTopic:
         Type: 'AWS::SNS::Topic'
         Properties:
            DisplayName: 'lambda-dlq-testing-SNSTopic'
            TopicName: 'lambda-dlq-testing-SNSTopic'
      SQSQueue:
         Type: 'AWS::SQS::Queue'
         Properties:
            QueueName: 'lambda-dlq-testing-SQSQueue'
